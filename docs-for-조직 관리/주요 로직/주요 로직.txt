## 조직 관리 주요 로직

### 1. 트리 구조 (Self-Referential)
- Organization 엔티티가 parent_id로 자기 자신을 참조
- 루트 조직: parent = null, depth = 0
- 하위 조직: parent = 상위 조직, depth = parent.depth + 1
- JPA @OneToMany children으로 자동 로딩 → 재귀적 트리 구성
- findByParentIsNull()로 루트만 조회하면 children이 자동으로 따라옴

### 2. 트리 응답 변환 (OrganizationTreeResponse.from)
Organization 엔티티 → DTO 변환 시 재귀적으로 children과 members를 포함
```
from(org) {
  children = org.getChildren().map(OrganizationTreeResponse::from)  // 재귀
  members  = org.getMembers().map(MemberResponse::from)
}
```

### 3. 조직 삭제 로직
- 삭제 전 소속 유저들의 organization을 null로 해제 (고아 방지)
- cascade ALL + orphanRemoval로 하위 조직은 자동 삭제
```
delete(id) {
  org = findOrThrow(id)
  for (member : org.getMembers()) → member.updateOrganization(null)
  organizationRepository.deleteById(id)
}
```

### 4. 유저-조직 연결
- User 엔티티에 @ManyToOne organization 필드
- assignUser: user.updateOrganization(org) → 해당 조직 소속으로 변경
- unassignUser: user.updateOrganization(null) → 미배정 상태로 변경
- JPA dirty checking으로 별도 save() 불필요 (@Transactional 내)

### 5. 권한 변경
- User.role 필드 (Role enum: USER, ADMIN)
- updateUserRole: user.updateRole(request.role())
- 프론트에서 select 드롭다운으로 즉시 변경

### 6. 프론트 상태 관리
- orgStore (Tanstack Store): selectedNode를 localStorage에 저장
- selectedNode 타입: { type: "org", id } | { type: "user", id }
- 유저 선택 시 → fetchMember(id) → MemberDetail 패널에 표시
- 조직 선택 시 → 상세 패널에 안내 메시지

### 7. 트리 UI 패턴
- OrgNode 컴포넌트가 재귀적으로 렌더링
- 각 조직 노드 아래에 children(하위 조직) + members(유저) 표시
- 유저 노드: UserIcon + 이름 + 권한 라벨 (관리자/일반)
- hover 시 액션 버튼 노출: 하위 조직 추가, 이름 변경, 삭제
- 인라인 편집: Enter 저장, Escape 취소

### 8. 패널 리사이즈
- DevSpecPage와 동일한 패턴
- mousedown → mousemove → mouseup 이벤트로 드래그
- 너비 범위: 200px ~ 500px
- localStorage에 'org-tree-width' 키로 저장
